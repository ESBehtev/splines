# Исходники P-сплайнов и B-сплайнов

В этом репозитории представлены несколько скриптов, демонстрирующих использование P-сплайнов и B-сплайнов для интерполяции данных, с пропусками, с шумом и ссылку на репозиторий библиотеки для работы со сплайнами.

## 1. Интерполяция данных с пропусками ([p_spline_gapped_data_interpolation.py](p_spline_gapped_data_interpolation.py))
Этот скрипт выполняет интерполяцию данных с пропусками с использованием P-сплайнов. Данные содержат синусоидальный сигнал, из которого удалены случайные 20%. Цель скрипта — восстановить эти данные.

### График:
![Interpolation with Gaps](images/img1.png)

---

## 2. Интерполяция с использованием P-сплайнов и пропусками ([p_spline_interpolation_with_gaps.py](p_spline_interpolation_with_gaps.py))
Скрипт реализует интерполяцию P-сплайнами для данных с пропусками. Пример демонстрирует восстановление синусоидального сигнала, у которого случайно удалены некоторые точки.

### График:
![P-Spline with Gaps](images/img2.png)

---

## 3. Интерполяция шумных данных с P-сплайнами ([p_spline_noisy_data.py](p_spline_noisy_data.py))
Скрипт выполняет интерполяцию данных с шумом, используя P-сплайны для сглаживания. Данные представляют собой синусоидальный сигнал с добавленным шумом.

### График:
![Noisy Data Interpolation](images/img3.png)

---

## 4. Оценка B-сплайна ([spline_evaluation.py](spline_evaluation.py))
Этот скрипт создает и визуализирует кубическую кривую B-сплайна с заданными контрольными точками. Он также рисует контрольный многоугольник и B-сплайн.

### График:
![B-Spline Evaluation](images/img4.png)

---

## 5. Интерполяция с B-сплайнами ([spline_interpolation.py](spline_interpolation.py))
Этот скрипт выполняет интерполяцию с использованием B-сплайнов для заранее определенных контрольных точек. Визуализируется как сама кривая сплайна, так и контрольные точки.

### График:
![Spline Interpolation](images/img5.png)

---

# 6. SplineLibrary

[Оригинальный репозиторий](https://github.com/ejmahler/SplineLibrary/tree/master)

**SplineLibrary** — это C++11 библиотека для работы со сплайнами, которая включает:

- Интерполяция различных типов сплайнов, включая:
  - Сплайн Catmull-Rom(Каталонский)
  - Равномерный кубический B-сплайн
  - Естественный сплайн
  - Центрипетальный сплайн Catmull-Rom
  - Обобщённый B-сплайн
  - Кубический эрмитов сплайн
  - Квинтический эрмитов сплайн
- Зацикленные (периодические) сплайны.
- Вычисление длины дуги сплайна.
- Обратное вычисление сплайна для нахождения ближайшей точки к заданной.
- Вычисление первой, второй и третьей производных сплайна (касательная, кривизна, "изгиб").

---

# 7. Реализация P-сплайнов с использованием библиотеки SciPy для интерполяции ([p_spline_fit_example.py](p_spline_fit_example.py))

[Оригинальный репозиторий](https://github.com/dswah/pyGAM/blob/master/pygam/terms.py)

- Основные функции
  - p_spline_basis(x, knots, degree): строит базисные функции B-сплайнов для     заданных узлов (knots) и степени (degree).
  - difference_matrix(n_bases, order): создаёт матрицу разностей для заданного порядка (order) для построения пенализующей матрицы.
  - it_p_spline(x, y, n_knots, degree, lam, diff_order): подбирает P-сплайн для данных x и y, используя указанные параметры: количество узлов, степень сплайна, параметр сглаживания \lambda и порядок разностей для пенализации.
- код генерирует случайные данные на основе синусоиды, добавляя шум. Затем данные подгоняются с помощью P-сплайна с заданными параметрами (количество узлов, степень, параметр сглаживания, порядок разностей).
Итоговое решение (сплайн) отображается на графике, где показываются истинные данные, зашумленные данные и результат подгонки сплайна.

### График:
![Noisy Data Interpolation](images/img6.png)

---
